# Universal Brain Template - Manifest
# Replace {{placeholders}} with actual values
# INCLUDES: LLM Enforcement Logic (REQUIRED for all brains)

brain:
  id: "{{brain_id}}"
  name: "{{brain_name}}"
  version: "1.0.0"
  created_at: "{{created_at}}"
  updated_at: "{{updated_at}}"
  purpose: "{{purpose}}"

objectives:
  primary_goal: "{{primary_goal}}"
  objectives:
    - description: "{{objective_1}}"
      success_criteria:
        - "{{criterion_1}}"
      priority: 1
  deliverables:
    - name: "{{deliverable_name}}"
      format: "{{format}}"
      required: true

# ═══════════════════════════════════════════════════════════════════
# CONSTRAINTS - LLM ENFORCEMENT LOGIC (CRITICAL)
# These rules prevent the 7 LLM Blind Spots
# ═══════════════════════════════════════════════════════════════════
constraints:
  # ─────────────────────────────────────────────────────────────────
  # STOP RULES - When to halt and ask user (CRITICAL)
  # Prevents: Helpfulness Bias, Implicit Assumptions
  # ─────────────────────────────────────────────────────────────────
  stop_rules:
    # Template/Dependency STOP rules
    - condition: "Required template/reference file is missing"
      action: "STOP and ask user - DO NOT generate from scratch"
      reason: "Generated content lacks tested styling/structure"

    - condition: "Template does not match required specification"
      action: "STOP and ask user - template must be updated"
      reason: "Wrong structure causes rendering/format errors"

    # Data Quality STOP rules
    - condition: "Unknown/unclassified data exceeds threshold (>10%)"
      action: "STOP and ask user - data quality issue"
      reason: "High unknowns indicate mapping or data problems"

    - condition: "Values outside expected range (anomaly detected)"
      action: "STOP and ask user - verify input data"
      reason: "Unusual values may indicate data entry errors"

    # Validation STOP rules
    - condition: "Any output file size is 0 bytes"
      action: "STOP and escalate - generation failed"
      reason: "Empty outputs will break downstream processes"

  # ─────────────────────────────────────────────────────────────────
  # MUST DO - Mandatory actions
  # Prevents: Partial Completion, Output Trust
  # ─────────────────────────────────────────────────────────────────
  must_do:
    # Pre-flight checks
    - "Run pre-flight checks before starting main workflow"
    - "STOP and ask user if required templates/references are missing - DO NOT generate from scratch"
    - "Verify templates match required specification before proceeding"
    - "Load business constants config and validate all values present"

    # During execution
    - "Apply business minimums and log any enforcement"
    - "Verify all dependent files exist and have size > 0"

    # QA (mandatory - never skip)
    - "Run verification on all critical outputs before marking complete"
    - "Verify zero unreplaced {{PLACEHOLDER}} tokens after template population"
    - "Verify all file paths resolve to existing files"

  # ─────────────────────────────────────────────────────────────────
  # MUST NOT - Forbidden actions (NEVER do these)
  # Prevents: Helpfulness Bias, Format Blindness
  # ─────────────────────────────────────────────────────────────────
  must_not:
    # Never improvise
    - "Generate content from scratch when template/reference is missing - ALWAYS stop and ask"
    - "Use simplified format when complex format is required"
    - "Skip any validation or verification step"
    - "Guess or assume values for missing data - always ask user"
    - "Mark a phase complete if validation fails - FIX first"

    # Output rules
    - "Deliver output with unreplaced template variables ({{PLACEHOLDER}} tokens)"
    - "Trust command exit code without verifying output files exist and have size > 0"
    - "Skip any QA step - all QA is mandatory"

# ═══════════════════════════════════════════════════════════════════
# BUSINESS CONSTANTS REFERENCE
# Load from config/<workflow>_constants.yaml
# ═══════════════════════════════════════════════════════════════════
config:
  constants_file: "config/{{brain_name}}_constants.yaml"
  # Critical items requiring extra validation
  critical_items: []

learning:
  enabled: true
  mode: "auto_safe"
  auto_update:
    edge_priorities: true
    edge_weights: true
    relationship_weights: true
    max_retries: true
    guard_thresholds: false
    node_prompts: false
    add_nodes: false
    remove_nodes: false
    add_edges: false
    remove_edges: false
  requires_approval:
    - "structural_changes"
    - "constraint_changes"
    - "new_skills"
  feedback_sources:
    - "outcome"
    - "user_feedback"
    - "quality_scores"

execution:
  max_steps: 100
  max_parallel: 5
  timeout_seconds: 3600
  max_retries: 3

skills:
  available:
    - "echo"
    - "calculator"
  auto_discover: true

metadata:
  tags:
    - "universal"
    - "template"
  notes: "Generated from universal template with LLM enforcement logic"
